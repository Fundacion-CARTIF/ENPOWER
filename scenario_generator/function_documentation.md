
# Function Documentation

## handle_demand_profile
**Description:**  
Calculates the demand profile for a building using its asset context, generation system profile, and consumption profile.

**Parameters:**  
- `building_asset_context` (dict): Context of the building's assets.
- `generation_system_profile` (dict): Energy system specifications.
- `consumption_profile` (dict): Building's consumption details.

**Returns:**  
- Calculated demand profile (dict) or an error message.

---

## calculate_self_consumption
**Description:**  
Calculates the self-consumption of electricity.

**Parameters:**  
- `total_electricity_use` (list): Electricity consumed.
- `total_PV` (list): Electricity generated by PV.

**Returns:**  
- Self-consumption values (list).

---

## calculate_rate_of_self_consumption
**Description:**  
Calculates the rate of self-consumption.

**Parameters:**  
- `self_consumption` (list): Self-consumed electricity.
- `total_PV` (list): Total PV electricity generated.

**Returns:**  
- Rate of self-consumption (list).

---

## calculate_grid_consumption
**Description:**  
Calculates electricity consumption from the grid.

**Parameters:**  
- `total_electricity_use` (list): Electricity consumed.
- `self_consumption` (list): Self-consumed electricity.

**Returns:**  
- Grid electricity consumption (list).

---

## calculate_self_sufficiency
**Description:**  
Calculates the self-sufficiency rate.

**Parameters:**  
- `self_consumption` (list): Self-consumed electricity.
- `total_electricity_use` (list): Total electricity consumed.

**Returns:**  
- Self-sufficiency rate (list).

---

## add_electricity_consumption
**Description:**  
Adds electricity consumption values.

**Parameters:**  
- `total_electricity_use` (list): Current total electricity usage.
- `consumption` (list): Additional electricity consumption to add.

**Returns:**  
- Updated electricity usage list.

---

## check_system_type_to_get_consumption
**Description:**  
Determines system type and corresponding consumption.

**Parameters:**  
- `system_name` (str): Name of the system.
- `consumption_profile` (dict): Consumption details.

**Returns:**  
- Consumption (list) and system type (str).

---

## instantiate_final_energy_with_json
**Description:**  
Instantiates energy carriers from a JSON file.

**Returns:**  
- Dictionary of final energy instances.

---

## load_energy_system_catalogue
**Description:**  
Loads the energy system catalogue from a JSON file.

**Returns:**  
- Energy system catalogue (dict).

---

## filter_energy_systems_catalogue
**Description:**  
Filters energy systems based on an ID.

**Parameters:**  
- `energy_systems_catalogue` (list): List of energy systems.
- `new_generation_system_id` (int): System ID to match.

**Returns:**  
- Matching energy system (dict).

---

## calculate_building_indicators
**Description:**  
Calculates key performance indicators (KPIs) for a building.

**Parameters:**  
- `consumption_profile` (dict): Energy consumption details.
- `generation_system_profile` (dict): Energy generation details.
- `building_energy_asset` (list): List of energy assets.
- `timestep_count` (int): Total time steps.

**Returns:**  
- Various calculated indicators (tuple).

---

## aggregate_demand_profiles
**Description:**  
Aggregates demand profiles across buildings.

**Parameters:**  
- `demand_profile` (list|dict): Demand profiles.

**Returns:**  
- Aggregated demand (dict).

---

## community_KPIs
**Description:**  
Calculates community-level KPIs based on individual building data.

**Parameters:**  
- `citizen_KPIs` (dict): Individual building KPIs.
- `total_demand` (dict): Total demand across buildings.
- `areas_buildings` (dict): Building areas.

**Returns:**  
- Aggregated community KPIs (dict).

---

## get_totals_per_building
**Description:**  
Calculates total indicators per building.

**Parameters:**  
- `KPIs` (dict): Building KPIs.
- `timestep_count` (int): Number of time steps.
- `final_energy` (dict): Final energy details.

**Returns:**  
- Various total indicators (tuple).
